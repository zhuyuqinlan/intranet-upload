# å±€åŸŸç½‘æ–‡ä»¶ä¸­å¿ƒ v1.1

ğŸŒ¸ åŸºäº Vue 3 + NestJS çš„ç°ä»£åŒ–å±€åŸŸç½‘æ–‡ä»¶å…±äº«ç³»ç»Ÿ

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Vue 3 (Composition API)
- **è¯­è¨€**: TypeScript
- **UI ç»„ä»¶åº“**: Naive UI
- **çŠ¶æ€ç®¡ç†**: Pinia
- **æ„å»ºå·¥å…·**: Vite
- **æ ·å¼**: SCSS

### åç«¯
- **æ¡†æ¶**: NestJS
- **è¯­è¨€**: TypeScript
- **æ–‡ä»¶ä¸Šä¼ **: Multer (åˆ†ç‰‡ä¸Šä¼ )
- **æ•°æ®å­˜å‚¨**: JSON æ–‡ä»¶

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“ **æ–‡ä»¶å¤¹ç®¡ç†**: æ”¯æŒåˆ›å»ºæ–‡ä»¶å¤¹ã€æ ‘å½¢ç›®å½•ç»“æ„ã€é¢åŒ…å±‘å¯¼èˆª
- ğŸš€ **åˆ†ç‰‡ä¸Šä¼ **: å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ 
- ğŸ”„ **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡åˆ é™¤ã€å¤šé€‰æ–‡ä»¶
- ğŸ” **æœç´¢è¿‡æ»¤**: å¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶
- ğŸ¨ **äºŒæ¬¡å…ƒé£æ ¼**: ç²‰è‰²ä¸»é¢˜ï¼Œåœ†è§’è®¾è®¡ï¼Œæµç•…åŠ¨ç”»
- ğŸ’¾ **ç¦»çº¿éƒ¨ç½²**: æ— å¤–éƒ¨ CDN ä¾èµ–ï¼Œé€‚åˆå†…ç½‘ç¯å¢ƒ

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- pnpm >= 8.0.0

### å®‰è£…

```bash
# å®‰è£… pnpmï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
npm install -g pnpm

# å®‰è£…ä¾èµ–
pnpm install
```

### å¼€å‘

```bash
# åŒæ—¶å¯åŠ¨å‰åç«¯å¼€å‘æœåŠ¡å™¨
pnpm dev

# æˆ–è€…åˆ†åˆ«å¯åŠ¨
pnpm --filter server dev  # åç«¯: http://localhost:9000
pnpm --filter web dev     # å‰ç«¯: http://localhost:5173
```

### æ„å»º

```bash
# æ„å»ºå‰åç«¯
pnpm build

# å•ç‹¬æ„å»º
pnpm build:server
pnpm build:web
```

### ç”Ÿäº§è¿è¡Œ

```bash
# æ„å»ºåå¯åŠ¨
pnpm build
pnpm start
```

è®¿é—®: http://localhost:9000

## é¡¹ç›®ç»“æ„

```
intranet-file-center/
â”œâ”€â”€ server/                    # NestJS åç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts           # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ app.module.ts     # æ ¹æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ config/           # é…ç½®
â”‚   â”‚   â”œâ”€â”€ common/           # é€šç”¨æ¨¡å—ï¼ˆå“åº”ã€å¼‚å¸¸æ‹¦æˆªå™¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ upload/           # åˆ†ç‰‡ä¸Šä¼ æ¨¡å—
â”‚   â”‚   â””â”€â”€ files/            # æ–‡ä»¶ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ web/                       # Vue3 å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts           # å…¥å£
â”‚   â”‚   â”œâ”€â”€ App.vue           # æ ¹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/              # API å°è£…
â”‚   â”‚   â”œâ”€â”€ composables/      # ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ stores/           # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ views/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â””â”€â”€ assets/styles/    # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ data/                      # æ•°æ®ç›®å½•ï¼ˆç»Ÿä¸€å­˜æ”¾ï¼‰
â”‚   â”œâ”€â”€ uploads/              # ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
â”‚   â”œâ”€â”€ temp/                 # åˆ†ç‰‡ä¸Šä¼ ä¸´æ—¶ç›®å½•
â”‚   â””â”€â”€ file-info.json        # æ–‡ä»¶å…ƒæ•°æ®
â”‚
â”œâ”€â”€ package.json              # Monorepo æ ¹é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ Dockerfile
â””â”€â”€ ecosystem.config.js       # PM2 é…ç½®
```

## é…ç½®

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# æœåŠ¡ç«¯å£
PORT=9000

# ç›®å½•é…ç½®ï¼ˆç»Ÿä¸€åœ¨ data ç›®å½•ä¸‹ï¼‰
UPLOAD_DIR=./data/uploads
TEMP_DIR=./data/temp
FILE_INFO_PATH=./data/file-info.json

# CORS é…ç½®
CORS_ORIGIN=*
```

## API æ¥å£

### ä¸Šä¼ æ¥å£

| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| POST | /api/upload/init | åˆå§‹åŒ–åˆ†ç‰‡ä¸Šä¼  |
| POST | /api/upload/chunk | ä¸Šä¼ åˆ†ç‰‡ |
| POST | /api/upload/complete | å®Œæˆä¸Šä¼  |

### æ–‡ä»¶ç®¡ç†æ¥å£

| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ |
|------|------|------|
| GET | /api/files | è·å–æ–‡ä»¶åˆ—è¡¨ |
| DELETE | /api/files/batch | æ‰¹é‡åˆ é™¤ |
| DELETE | /api/files/:id | åˆ é™¤å•ä¸ªæ–‡ä»¶ |
| GET | /api/download/:id | ä¸‹è½½æ–‡ä»¶ |
| POST | /api/folders | åˆ›å»ºæ–‡ä»¶å¤¹ |
| GET | /api/stats | è·å–ç»Ÿè®¡ä¿¡æ¯ |

## å†…ç½‘éƒ¨ç½²

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t file-center .

# è¿è¡Œå®¹å™¨
docker run -d -p 9000:9000 -v $(pwd)/data:/app/data file-center
```

### PM2 éƒ¨ç½²

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨æœåŠ¡
pm2 start ecosystem.config.js

# å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

## æ³¨æ„äº‹é¡¹

- âš ï¸ åˆ é™¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œ
- âš ï¸ å¤§æ–‡ä»¶ä¸Šä¼ éœ€è¦ç¨³å®šçš„ç½‘ç»œç¯å¢ƒ
- âš ï¸ å®šæœŸæ¸…ç† `data/temp/` ç›®å½•
- âš ï¸ å¤‡ä»½ `data/` ç›®å½•ä»¥é˜²æ­¢æ•°æ®ä¸¢å¤±

## License

ISC
